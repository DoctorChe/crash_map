# Mari El Republic Crash Map

This project contains back-end and front-end code written for visualization of crashes on the roads of Mari El republic.

## Usage

There are two parts of this project: back-end and front-end. Back-end is written on Python and front-end is on Javascript. Also there is an `data.csv` file which was created from data provided by GIBDD of Mari El Republic and contains information about road accidents in Mari El Republic in 2015.

### Back-end

End-to-end process for preparation data for front-end looks like this:

1. Run `geocoding.py`.
2. Run `data_verification.py`.
3. Run `generate_data.py`.

#### Geocoding

Geocoding process is added in order visualize data based on address information from input data. Script is using [Yandex Geocoder](https://tech.yandex.ru/maps/geocoder/) to create temporary storage of geocoding data for the sole purpose of improving the functionality and performance capacity of crash map visualization.

To run it simply use:

```
python geocoding.py
```

Input data is `input.scv` from data directory. Output is `input_geocoded.csv` which will be added also into data directory.

#### Data verification

Verification consists of:

* verification of date and time values;
* checking of confused latitude and longitude in input data (with fixing of them);
* verification of coordinates based on bounderies of Mari El republic and Yoshkar-Ola;
* verification of coordinates based on coordinates recieved from geocoder;
* etc.

In order to identify quality of the data before visualization you should run:

```
python data_verification.py
```

Input data is `input_geocoded.csv` from data directory generated by `geocoding.py`. Output is `input_verified.csv` which will be added also into data directory.

#### Generation of data

Once geocoding and data verification processes are completed you should be able to generate `data.js` file which will be used by front-end part by simple:

```
python generate_data.py
```

Input data is `input_verified.csv` from data directory generated by `data_verification.py`. Output is `data.js` which will be added also into data directory.

#### Generation of statistics

After data verification process there is a possibility to generate some crashes statistics by running:

```
python generate_statistics.py
```

Input data is `input_verified.csv` from data directory generated by `data_verification.py`. Statistics will be printed to output as a plain test in Russian with details on road accidents for Mari El republic and Yoshkar-Ola. Statistics includes for example:

* statistics on crashes broken by administrative district;
* statistics on crashes broken by types;
* statistics of injuries and deaths in road accidents;
* data validation statistics;
* etc.

### Front-end

Since for visualization was used [JSFiddle](https://jsfiddle.net/) front-end part consists of html, css and js files that you can just copy-paste to your fiddle. Besides this code you will also need to:

1. enable in JSFiddle interface:
   1. JQuery Framework (2.1.4);
   2. enable JQuery UI library (1.11.4);
2. include as external resource:
   1. [jquery.timepicker library](https://github.com/jonthornton/jquery-timepicker) (including css);
   2. [Yandex Maps API](http://api-maps.yandex.ru/2.1/?lang=ru_RU);
   3. [heatmap library](https://github.com/yandex/mapsapi-heatmap);
   4. `data.js` which you can found in data directory of this project after compliting of back-end process.